# ///////////////////////////////////////////////////////////////////////////////////////
# Unit Test JetStore server process
# ---------------------------------------------------------------------------------------
import "support_test2.jr"

# ========================================================================
# Create Claim for Patient
# -----------------------------------------------------------------------
# Pick a claim profile from each claim_group_lookup_key
[MEC310]:
  (?patient rdf:type hc:SimulatedPatient).
  (?patient hc:patient_number ?key).
  (?patient asim:claim_group_lk_key ?uri)
  ->
  (?patient asim:claim_profile (multi_lookup_rand ?uri))
;

## # For each asim:claim_profile row create a corresponding claim entity
## [MEC410]:
##   (?patient rdf:type hc:SimulatedPatient).
##   (?patient hc:patient_number ?key).
##   (?patient asim:claim_profile ?multi_row).
##   (?multi_row jets:lookup_multi_rows ?row).
##   (?row asim:event_key ?ekey)
##   ->
##   (?patient ?row create_entity (("C" + ?key) + ("E" + ?ekey)))
## ;
## 
## [MEC510]:
##   (?patient rdf:type hc:SimulatedPatient).
##   (?patient asim:claim_profile ?multi_row).
##   (?multi_row jets:lookup_multi_rows ?row).
##   (?row asim:event_key ?ekey).
##   (?patient hc:patient_number ?pnbr).
##   (?patient ?row ?claim).
##   ->
##   (?claim rdf:type hc:SimulatedClaim).
##   (?claim hc:member_number ?pnbr)
##   (?claim asim:claim_row ?row)
## ;
